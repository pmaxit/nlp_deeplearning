---

title: Training a custom text classifier


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/FlairNLP.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/FlairNLP.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">flair.models</span> <span class="kn">import</span> <span class="n">TextClassifier</span>
<span class="kn">from</span> <span class="nn">flair.data</span> <span class="kn">import</span> <span class="n">Sentence</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">TextClassifier</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en-sentiment&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:05:49,299 https://nlp.informatik.hu-berlin.de/resources/models/sentiment-curated-distilbert/sentiment-en-mix-distillbert_4.pt not found in cache, downloading to /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpfmpxfjtj
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 265512723/265512723 [00:31&lt;00:00, 8437568.05B/s] </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:06:21,238 copying /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpfmpxfjtj to cache at /Users/puneet/.flair/models/sentiment-en-mix-distillbert_4.pt
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:06:21,591 removing temp file /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpfmpxfjtj
2021-03-12 10:06:21,611 loading file /Users/puneet/.flair/models/sentiment-en-mix-distillbert_4.pt


</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentence</span> <span class="o">=</span> <span class="n">Sentence</span><span class="p">(</span><span class="s1">&#39;Flair is pretty neat!&#39;</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sentence above is: &#39;</span><span class="p">,</span> <span class="n">sentence</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Sentence above is:  [POSITIVE (0.9997)]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/train.csv&quot;</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../data/test.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>text</th>
      <th>author</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id26305</td>
      <td>This process, however, afforded me no means of...</td>
      <td>EAP</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id17569</td>
      <td>It never once occurred to me that the fumbling...</td>
      <td>HPL</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id11008</td>
      <td>In his left hand was a gold snuff box, from wh...</td>
      <td>EAP</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id27763</td>
      <td>How lovely is spring As we looked from Windsor...</td>
      <td>MWS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id12958</td>
      <td>Finding nothing else, not even gold, the Super...</td>
      <td>HPL</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;author&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;author&#39;</span><span class="p">:</span><span class="s1">&#39;label&#39;</span><span class="p">})</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;__label__&#39;</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">)]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;temp/train.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">):</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="mf">0.9</span><span class="p">)]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;temp/test.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="mf">0.9</span><span class="p">):]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;temp/dev.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training-a-classifier">Training a classifier<a class="anchor-link" href="#Training-a-classifier"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">flair.data_fetcher</span> <span class="kn">import</span> <span class="n">NLPTaskDataFetcher</span>
<span class="kn">from</span> <span class="nn">flair.embeddings</span> <span class="kn">import</span> <span class="n">WordEmbeddings</span><span class="p">,</span> <span class="n">FlairEmbeddings</span><span class="p">,</span> <span class="n">DocumentLSTMEmbeddings</span>
<span class="kn">from</span> <span class="nn">flair.models</span> <span class="kn">import</span> <span class="n">TextClassifier</span>
<span class="kn">from</span> <span class="nn">flair.trainers</span> <span class="kn">import</span> <span class="n">ModelTrainer</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">flair.data</span> <span class="kn">import</span> <span class="n">Corpus</span>
<span class="kn">from</span> <span class="nn">flair.datasets</span> <span class="kn">import</span> <span class="n">ClassificationCorpus</span>

<span class="c1"># this is the folder in which train, test and dev files reside</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="s1">&#39;./temp&#39;</span>

<span class="c1"># load corpus containing training, test and dev data</span>
<span class="n">corpus</span><span class="p">:</span> <span class="n">Corpus</span> <span class="o">=</span> <span class="n">ClassificationCorpus</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span>
                                      <span class="n">test_file</span><span class="o">=</span><span class="s1">&#39;test.csv&#39;</span><span class="p">,</span>
                                      <span class="n">dev_file</span><span class="o">=</span><span class="s1">&#39;dev.csv&#39;</span><span class="p">,</span>
                                      <span class="n">train_file</span><span class="o">=</span><span class="s1">&#39;train.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:11,084 Reading data from temp
2021-03-12 10:19:11,085 Train: temp/train.csv
2021-03-12 10:19:11,085 Dev: temp/dev.csv
2021-03-12 10:19:11,086 Test: temp/test.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">word_embeddings</span> <span class="o">=</span> <span class="p">[</span><span class="n">WordEmbeddings</span><span class="p">(</span><span class="s1">&#39;glove&#39;</span><span class="p">),</span> <span class="n">FlairEmbeddings</span><span class="p">(</span><span class="s1">&#39;news-forward-fast&#39;</span><span class="p">),</span> <span class="n">FlairEmbeddings</span><span class="p">(</span><span class="s1">&#39;news-backward-fast&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:36,680 https://flair.informatik.hu-berlin.de/resources/embeddings/token/glove.gensim.vectors.npy not found in cache, downloading to /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmp4wj73ye6
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 160000128/160000128 [00:12&lt;00:00, 12616893.60B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:49,874 copying /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmp4wj73ye6 to cache at /Users/puneet/.flair/embeddings/glove.gensim.vectors.npy
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:50,171 removing temp file /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmp4wj73ye6
2021-03-12 10:19:50,673 https://flair.informatik.hu-berlin.de/resources/embeddings/token/glove.gensim not found in cache, downloading to /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpls3ky6mi
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 21494764/21494764 [00:03&lt;00:00, 6283289.68B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:54,520 copying /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpls3ky6mi to cache at /Users/puneet/.flair/embeddings/glove.gensim
2021-03-12 10:19:54,555 removing temp file /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpls3ky6mi
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:56,373 https://flair.informatik.hu-berlin.de/resources/embeddings/flair/lm-news-english-forward-1024-v0.2rc.pt not found in cache, downloading to /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpaanh816y
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 19689779/19689779 [00:02&lt;00:00, 7406853.36B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:19:59,462 copying /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpaanh816y to cache at /Users/puneet/.flair/embeddings/lm-news-english-forward-1024-v0.2rc.pt
2021-03-12 10:19:59,493 removing temp file /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpaanh816y
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:20:00,006 https://flair.informatik.hu-berlin.de/resources/embeddings/flair/lm-news-english-backward-1024-v0.2rc.pt not found in cache, downloading to /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpev5x6_01
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 19689779/19689779 [00:02&lt;00:00, 8067511.30B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:20:02,897 copying /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpev5x6_01 to cache at /Users/puneet/.flair/embeddings/lm-news-english-backward-1024-v0.2rc.pt
2021-03-12 10:20:02,930 removing temp file /var/folders/x5/5m2qt29d3493hj8vtxfdxs0h0000gn/T/tmpev5x6_01
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">document_embeddings</span> <span class="o">=</span> <span class="n">DocumentLSTMEmbeddings</span><span class="p">(</span><span class="n">word_embeddings</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">reproject_words</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reproject_words_dimension</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>&lt;ipython-input-19-a9bdbbe77cfc&gt;:1: DeprecationWarning: Call to deprecated method __init__. (The functionality of this class is moved to &#39;DocumentRNNEmbeddings&#39;) -- Deprecated since version 0.4.
  document_embeddings = DocumentLSTMEmbeddings(word_embeddings, hidden_size=512, reproject_words=True, reproject_words_dimension=256)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">TextClassifier</span><span class="p">(</span><span class="n">document_embeddings</span><span class="p">,</span> <span class="n">label_dictionary</span><span class="o">=</span><span class="n">corpus</span><span class="o">.</span><span class="n">make_label_dictionary</span><span class="p">(),</span> <span class="n">multi_label</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:20:17,602 Computing label dictionary. Progress:
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 17621/17621 [00:05&lt;00:00, 3111.09it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:20:40,802 [b&#39;MWS&#39;, b&#39;HPL&#39;, b&#39;EAP&#39;]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="n">ModelTrainer</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
              <span class="n">mini_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
              <span class="n">anneal_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
              <span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:21:12,547 ----------------------------------------------------------------------------------------------------
2021-03-12 10:21:12,548 Model: &#34;TextClassifier(
  (document_embeddings): DocumentLSTMEmbeddings(
    (embeddings): StackedEmbeddings(
      (list_embedding_0): WordEmbeddings(&#39;glove&#39;)
      (list_embedding_1): FlairEmbeddings(
        (lm): LanguageModel(
          (drop): Dropout(p=0.25, inplace=False)
          (encoder): Embedding(275, 100)
          (rnn): LSTM(100, 1024)
          (decoder): Linear(in_features=1024, out_features=275, bias=True)
        )
      )
      (list_embedding_2): FlairEmbeddings(
        (lm): LanguageModel(
          (drop): Dropout(p=0.25, inplace=False)
          (encoder): Embedding(275, 100)
          (rnn): LSTM(100, 1024)
          (decoder): Linear(in_features=1024, out_features=275, bias=True)
        )
      )
    )
    (word_reprojection_map): Linear(in_features=2148, out_features=256, bias=True)
    (rnn): GRU(256, 512)
    (dropout): Dropout(p=0.5, inplace=False)
  )
  (decoder): Linear(in_features=512, out_features=3, bias=True)
  (loss_function): CrossEntropyLoss()
  (beta): 1.0
  (weights): None
  (weight_tensor) None
)&#34;
2021-03-12 10:21:12,549 ----------------------------------------------------------------------------------------------------
2021-03-12 10:21:12,549 Corpus: &#34;Corpus: 15663 train + 1958 dev + 1958 test sentences&#34;
2021-03-12 10:21:12,550 ----------------------------------------------------------------------------------------------------
2021-03-12 10:21:12,551 Parameters:
2021-03-12 10:21:12,551  - learning_rate: &#34;0.1&#34;
2021-03-12 10:21:12,552  - mini_batch_size: &#34;32&#34;
2021-03-12 10:21:12,552  - patience: &#34;5&#34;
2021-03-12 10:21:12,553  - anneal_factor: &#34;0.5&#34;
2021-03-12 10:21:12,554  - max_epochs: &#34;10&#34;
2021-03-12 10:21:12,555  - shuffle: &#34;True&#34;
2021-03-12 10:21:12,555  - train_with_dev: &#34;False&#34;
2021-03-12 10:21:12,556  - batch_growth_annealing: &#34;False&#34;
2021-03-12 10:21:12,556 ----------------------------------------------------------------------------------------------------
2021-03-12 10:21:12,557 Model training base path: &#34;.&#34;
2021-03-12 10:21:12,558 ----------------------------------------------------------------------------------------------------
2021-03-12 10:21:12,559 Device: cpu
2021-03-12 10:21:12,560 ----------------------------------------------------------------------------------------------------
2021-03-12 10:21:12,560 Embeddings storage mode: cpu
2021-03-12 10:21:12,562 ----------------------------------------------------------------------------------------------------
2021-03-12 10:24:20,312 epoch 1 - iter 49/490 - loss 1.10868099 - samples/sec: 8.92 - lr: 0.100000
2021-03-12 10:27:13,469 epoch 1 - iter 98/490 - loss 1.08850953 - samples/sec: 9.16 - lr: 0.100000
2021-03-12 10:30:07,827 epoch 1 - iter 147/490 - loss 1.07646150 - samples/sec: 9.07 - lr: 0.100000
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Exception ignored in: &lt;function _MultiProcessingDataLoaderIter.__del__ at 0x145be58b0&gt;
Traceback (most recent call last):
  File &#34;/Users/puneet/.virtualenvs/torch/lib/python3.9/site-packages/torch/utils/data/dataloader.py&#34;, line 1203, in __del__
    self._shutdown_workers()
  File &#34;/Users/puneet/.virtualenvs/torch/lib/python3.9/site-packages/torch/utils/data/dataloader.py&#34;, line 1177, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File &#34;/usr/local/Cellar/python@3.9/3.9.2/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/process.py&#34;, line 149, in join
    res = self._popen.wait(timeout)
  File &#34;/usr/local/Cellar/python@3.9/3.9.2/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/popen_fork.py&#34;, line 40, in wait
    if not wait([self.sentinel], timeout):
  File &#34;/usr/local/Cellar/python@3.9/3.9.2/Frameworks/Python.framework/Versions/3.9/lib/python3.9/multiprocessing/connection.py&#34;, line 936, in wait
    ready = selector.select(timeout)
  File &#34;/usr/local/Cellar/python@3.9/3.9.2/Frameworks/Python.framework/Versions/3.9/lib/python3.9/selectors.py&#34;, line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt: 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-03-12 10:31:26,589 ----------------------------------------------------------------------------------------------------
2021-03-12 10:31:26,592 Exiting from training early.
2021-03-12 10:31:26,593 Saving model ...
2021-03-12 10:31:29,561 Done.
2021-03-12 10:31:29,568 ----------------------------------------------------------------------------------------------------
2021-03-12 10:31:29,569 Testing using best model ...
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

